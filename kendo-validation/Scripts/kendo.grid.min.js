/*
* Kendo UI Complete v2012.3.1114 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
(function(e,t){function r(e){return Array(e+1).join('<td class="k-group-cell">&nbsp;</td>')}function a(e){var t,r=" ";if(e){if(typeof e===lt)return e;for(t in e)r+=t+'="'+e[t]+'"'}return r}function o(t){var r=0;return e("> .k-grouping-header, > .k-grid-toolbar",t).each(function(){r+=this.offsetHeight}),r}function l(t,r){e("th, th .k-grid-filter, th .k-link",t).add(document.body).css("cursor",r)}function i(e){var t,r,a={},o={};if(!D(e))for(T(e)||(e=[e]),t=0,r=e.length;r>t;t++)a[e[t].aggregate]=0,o[e[t].field]=a;return o}function n(e,t,r){var a=e.eq(t),o=e.eq(r);a[t>r?"insertBefore":"insertAfter"](o)}function s(e,t,r){var a,o,l,i;for(r=T(r)?r:[r],a=0,o=r.length;o>a;a++)l=r[a],y(l)&&l.click&&(i=l.name||l.text,t.on("touchend "+tt,"a.k-grid-"+(i||"").replace(/\s/g,""),{commandName:i},R(l.click,e)))}function d(e){return x(e,function(e){return!e.hidden})}function c(e){e=e||{};var t=e.style;return t?(t=t.replace(/((.*)?display)(.*)?:([^;]*)/i,"$1:none"),t===e.style&&(t=t.replace(/(.*)?/i,"display:none;$1"))):t="display:none",C({},e,{style:t})}function u(e){e=e||{};var t=e.style;return t&&(e.style=t.replace(/(display\s*:\s*none\s*;?)*/gi,"")),e}function p(t,r,a,o){var l,i=t.find(">colgroup"),n=S(r,function(e){return l=e.width,l&&0!==parseInt(l,10)?g.format('<col style="width:{0}"/>',typeof l===lt?l:l+"px"):"<col />"});(a||i.find(".k-hierarchy-col").length)&&n.splice(0,0,'<col class="k-hierarchy-col" />'),i.length&&i.remove(),i=e("<colgroup/>").append(e(Array(o+1).join('<col class="k-group-col">')+n.join(""))),t.prepend(i)}function h(e,t){var r,a,o;if(typeof e===lt&&e===t)return e;if(y(e)&&e.name===t)return e;if(T(e))for(r=0,a=e.length;a>r;r++)if(o=e[r],typeof o===lt&&o===t||o.name===t)return o;return null}function f(t){var r=e(t.currentTarget),a=r.closest("table")[0];(a===this.table[0]||a===this.thead.parent()[0])&&(this.current(r),(r.is("th")||!e(t.target).is(":button,a,:input,a>.k-icon,textarea,span.k-icon,.k-input"))&&setTimeout(function(){a.focus()}),r.is("th")&&t.preventDefault())}var g=window.kendo,m=g.ui,b=g.data.DataSource,k=m.Groupable,v=g.support.tbodyInnerHtml,_=m.Widget,w=g.keys,y=e.isPlainObject,C=e.extend,S=e.map,x=e.grep,T=e.isArray,H=e.inArray,R=e.proxy,A=e.isFunction,D=e.isEmptyObject,E=Math,I="requestStart",M="error",W=":not(.k-group-cell):not(.k-hierarchy-cell):visible",q="tbody>tr:not(.k-grouping-row):not(.k-detail-row):not(.k-group-footer) > td:not(.k-group-cell):not(.k-hierarchy-cell)",N="tr:not(.k-footer-template):visible",B=":not(.k-group-cell):not(.k-hierarchy-cell):visible",z=N+":first>"+B+":first",L=".kendoGrid",F="edit",P="save",O="remove",G="detailInit",j="change",U="columnHide",$="columnShow",K="saveChanges",J="dataBound",V="detailExpand",X="detailCollapse",Q="k-state-focused",Y="k-state-selected",Z="columnResize",et="columnReorder",tt="click",rt="height",at="tabIndex",ot="function",lt="string",it="Are you sure you want to delete this record?",nt=/(\}|\#)/gi,st=3,dt=/#/gi,ct='<a class="k-button k-button-icontext #=className#" #=attr# href="\\#"><span class="#=iconClass# #=imageClass#"></span>#=text#</a>',ut=!1,pt=_.extend({init:function(e,t){var r=this;_.fn.init.call(r,e,t),r._refreshHandler=R(r.refresh,r),r.setDataSource(t.dataSource),r.wrap()},setDataSource:function(e){var t=this;t.dataSource&&t.dataSource.unbind(j,t._refreshHandler),t.dataSource=e,t.dataSource.bind(j,t._refreshHandler)},options:{name:"VirtualScrollable",itemHeight:e.noop},destroy:function(){var e=this;_.fn.destroy.call(e),e.dataSource.unbind(j,e._refreshHandler),e.wrapper.add(e.verticalScrollbar).off(L),e.drag&&e.drag.destroy()},wrap:function(){var t,r=this,a=g.support.scrollbar()+1,o=r.element;o.css({width:"auto",overflow:"hidden"}).css(ut?"padding-left":"padding-right",a),r.content=o.children().first(),t=r.wrapper=r.content.wrap('<div class="k-virtual-scrollable-wrap"/>').parent().bind("DOMMouseScroll"+L+" mousewheel"+L,R(r._wheelScroll,r)),g.support.kineticScrollNeeded&&(r.drag=new g.UserEvents(r.wrapper,{global:!0,move:function(e){r.verticalScrollbar.scrollTop(r.verticalScrollbar.scrollTop()-e.y.delta),t.scrollLeft(t.scrollLeft()-e.x.delta),e.preventDefault()}})),r.verticalScrollbar=e('<div class="k-scrollbar k-scrollbar-vertical" />').css({width:a}).appendTo(o).bind("scroll"+L,R(r._scroll,r))},_wheelScroll:function(e){var r,a=this,o=a.verticalScrollbar.scrollTop(),l=e.originalEvent,i=l.wheelDeltaY;l.wheelDelta?(i===t||i)&&(r=l.wheelDelta):l.detail&&l.axis===l.VERTICAL_AXIS&&(r=10*-l.detail),r&&(e.preventDefault(),a.verticalScrollbar.scrollTop(o+-r))},_scroll:function(e){var t=this,r=e.currentTarget.scrollTop,a=t.dataSource,o=t.itemHeight,l=a.skip()||0,i=t._rangeStart||l,n=t.element.innerHeight(),s=!!(t._scrollbarTop&&t._scrollbarTop>r),d=E.max(E.floor(r/o),0),c=E.max(d+E.floor(n/o),0);t._scrollTop=r-i*o,t._scrollbarTop=r,t._fetch(d,c,s)||(t.wrapper[0].scrollTop=t._scrollTop)},_fetch:function(e,t,r){var a=this,o=a.dataSource,l=a.itemHeight,i=o.take(),n=a._rangeStart||o.skip()||0,s=E.floor(e/i)*i,d=!1,c=.33;return n>e?(d=!0,n=E.max(0,t-i),a._scrollTop=(e-n)*l,a._page(n,i)):t>=n+i&&!r?(d=!0,n=e,a._scrollTop=l,a._page(n,i)):a._fetching||(s+i-i*c>e&&e>i&&o.prefetch(s-i,i),t>s+i*c&&o.prefetch(s+i,i)),d},_page:function(e,t){var r=this,a=r.dataSource;clearTimeout(r._timeout),r._fetching=!0,r._rangeStart=e,a.inRange(e,t)?a.range(e,t):(g.ui.progress(r.wrapper.parent(),!0),r._timeout=setTimeout(function(){a.range(e,t)},100))},refresh:function(){var e,t,r,a=this,o="",l=25e4,i=a.dataSource,n=a._rangeStart,s=g.support.kineticScrollNeeded?0:g.support.scrollbar(),d=a.wrapper[0];g.ui.progress(a.wrapper.parent(),!1),clearTimeout(a._timeout),r=a.itemHeight=a.options.itemHeight()||0;var c=d.scrollWidth>d.offsetWidth?s:0;for(e=i.total()*r+c,t=0;E.floor(e/l)>t;t++)o+='<div style="width:1px;height:'+l+'px"></div>';e%l&&(o+='<div style="width:1px;height:'+e%l+'px"></div>'),a.verticalScrollbar.html(o),d.scrollTop=a._scrollTop,a.drag&&a.drag.cancel(),n&&!a._fetching&&(a._rangeStart=i.skip()),a._fetching=!1}}),ht={create:{text:"Add new record",imageClass:"k-add",className:"k-grid-add",iconClass:"k-icon"},cancel:{text:"Cancel changes",imageClass:"k-cancel",className:"k-grid-cancel-changes",iconClass:"k-icon"},save:{text:"Save changes",imageClass:"k-update",className:"k-grid-save-changes",iconClass:"k-icon"},destroy:{text:"Delete",imageClass:"k-delete",className:"k-grid-delete",iconClass:"k-icon"},edit:{text:"Edit",imageClass:"k-edit",className:"k-grid-edit",iconClass:"k-icon"},update:{text:"Update",imageClass:"k-update",className:"k-grid-update",iconClass:"k-icon"},canceledit:{text:"Cancel",imageClass:"k-cancel",className:"k-grid-cancel",iconClass:"k-icon"}},ft=_.extend({init:function(e,t){var r=this;t=T(t)?{dataSource:t}:t,_.fn.init.call(r,e,t),ut=g.support.isRtl(e),r._element(),r._aria(),r._columns(r.options.columns),r._dataSource(),r._tbody(),r._pageable(),r._thead(),r._groupable(),r._toolbar(),r._setContentHeight(),r._templates(),r._navigatable(),r._selectable(),r._details(),r._editable(),r._attachCustomCommandsEvent(),r.options.autoBind?r.dataSource.fetch():r._footer(),g.notify(r)},events:[j,"dataBinding",J,V,X,G,F,P,O,K,Z,et,$,U],setDataSource:function(e){var t=this;t.options.dataSource=e,t._dataSource(),t._pageable(),t.options.groupable&&t._groupable(),t._thead(),t.virtualScrollable&&t.virtualScrollable.setDataSource(t.options.dataSource),t.options.autoBind&&e.fetch()},options:{name:"Grid",columns:[],toolbar:null,autoBind:!0,filterable:!1,scrollable:!0,sortable:!1,selectable:!1,navigatable:!1,pageable:!1,editable:!1,groupable:!1,rowTemplate:"",altRowTemplate:"",dataSource:{},height:null,resizable:!1,reorderable:!1,columnMenu:!1,detailTemplate:null},destroy:function(){var t=this;_.fn.destroy.call(t),t.pager&&t.pager.destroy(),t.groupable&&t.groupable.destroy(),t.virtualScrollable&&t.virtualScrollable.destroy(),t.thead.find("th").each(function(){var t=e(this),r=t.data("kendoFilterMenu"),a=t.data("kendoSortable"),o=t.data("kendoColumnMenu");r&&r.destroy(),a&&a.destroy(),o&&o.destroy()}),t._destroyEditable(),t.dataSource.unbind(j,t._refreshHandler).unbind(I,t._requestStartHandler).unbind(M,t._errorHandler),t.element.add(t.wrapper).add(t.table).add(t.thead).add(t.wrapper.find(">.k-grid-toolbar")),t.content&&t.element.add(t.content).add(t.content.find(">.k-virtual-scrollable-wrap")),t.element.off(L),g.destroy(t.wrapper)},setOptions:function(e){var t=this;_.fn.setOptions.call(this,e),t._templates()},items:function(){return this.tbody.children(":not(.k-grouping-row,.k-detail-row,.k-group-footer)")},_attachCustomCommandsEvent:function(){var e,t,r,a=this,o=a.columns||[];for(t=0,r=o.length;r>t;t++)e=o[t].command,e&&s(a,a.wrapper,e)},_aria:function(){var e=this.element.attr("id")||"aria";e&&(this._cellId=e+"_active_cell")},_element:function(){var t=this,r=t.element;r.is("table")||(r=t.options.scrollable?t.element.find("> .k-grid-content > table"):t.element.children("table"),r.length||(r=e("<table />").appendTo(t.element))),t.table=r.attr("cellspacing",0).attr("role",t._hasDetails()?"treegrid":"grid"),t._wrapper()},_positionColumnResizeHandle:function(t){var r,a=this,i=a.options.scrollable,n=a.resizeHandle;a.thead.on("mousemove"+L,"th:not(.k-group-cell,.k-hierarchy-cell)",function(s){var d=e(this),c=s.clientX,u=e(window).scrollLeft(),p=d.offset().left+(ut?0:this.offsetWidth);if(c+u>p-st&&p+st>c+u){if(n||(n=a.resizeHandle=e('<div class="k-resize-handle"/>'),t.append(n)),ut){var h=d.closest(".k-grid-header-wrap"),f=e.browser.msie?h.scrollLeft():0,g=e.browser.webkit?h[0].scrollWidth-h[0].offsetWidth-h.scrollLeft():0,m=e.browser.mozilla?h[0].scrollWidth-h[0].offsetWidth-(h[0].scrollWidth-h[0].offsetWidth-h.scrollLeft()):0;r=d.position().left-g+m-f}else r=this.offsetWidth,d.prevAll(":visible").each(function(){r+=this.offsetWidth});n.css({top:i?0:o(a.wrapper),left:r-st,height:d.outerHeight(),width:3*st}).data("th",d).show()}else n?n.hide():l(a.wrapper,"")})},_resizable:function(){var t,r,a,o,i,n=this,s=n.options;s.resizable&&(t=s.scrollable?n.wrapper.find(".k-grid-header-wrap:first"):n.wrapper,n._positionColumnResizeHandle(t),t.kendoResizable({handle:".k-resize-handle",hint:function(t){return e('<div class="k-grid-resize-indicator" />').css({height:t.data("th").outerHeight()+n.tbody.attr("clientHeight")})},start:function(t){var d=e(t.currentTarget).data("th"),c=e.inArray(d[0],d.parent().children(":visible")),u=n.tbody.parent(),p=n.footer||e();l(n.wrapper,"col-resize"),i=s.scrollable?n.thead.parent().find("col:eq("+c+")").add(u.children("colgroup").find("col:eq("+c+")")).add(p.find("colgroup").find("col:eq("+c+")")):u.children("colgroup").find("col:eq("+c+")"),r=t.x.location,a=d.outerWidth(),o=n.tbody.outerWidth()},resize:function(t){var l=ut?-1:1,d=a+t.x.location*l-r*l,c=n.footer||e();d>10&&(i.css("width",d),s.scrollable&&(n._footerWidth=o+t.x.location*l-r*l,n.tbody.parent().add(n.thead.parent()).add(c.find("table")).css("width",n._footerWidth)))},resizeend:function(t){var r,o=e(t.currentTarget).data("th"),i=o.outerWidth();l(n.wrapper,""),a!=i&&(r=n.columns[o.parent().find("th:not(.k-group-cell,.k-hierarchy-cell)").index(o)],r.width=i,n.trigger(Z,{column:r,oldWidth:a,newWidth:i})),n.resizeHandle.hide()}}))},_draggable:function(){var t=this;t.options.reorderable&&(t._draggableInstance=t.wrapper.kendoDraggable({group:g.guid(),filter:".k-header:not(.k-group-cell,.k-hierarchy-cell)",hint:function(t){return e('<div class="k-header k-drag-clue" />').css({width:t.width(),paddingLeft:t.css("paddingLeft"),paddingRight:t.css("paddingRight"),lineHeight:t.height()+"px",paddingTop:t.css("paddingTop"),paddingBottom:t.css("paddingBottom")}).html(t.attr(g.attr("title"))||t.attr(g.attr("field"))||t.text()).prepend('<span class="k-icon k-drag-status k-denied" />')}}).data("kendoDraggable"))},_reorderable:function(){var e=this;e.options.reorderable&&e.thead.kendoReorderable({draggable:e._draggableInstance,change:function(t){var r=H(e.columns[t.newIndex],e.columns),a=e.columns[t.oldIndex];e.trigger(et,{newIndex:r,oldIndex:H(a,e.columns),column:a}),e.reorderColumn(r,a)}})},reorderColumn:function(e,t){var r,a,o,l=this,i=H(t,l.columns),s=H(t,d(l.columns)),c=l.footer||l.wrapper.find(".k-grid-footer");if(i!==e)for(l.columns.splice(i,1),l.columns.splice(e,0,t),l._templates(),n(l.thead.prev().find("col:not(.k-group-col,.k-hierarchy-col)"),s,e),l.options.scrollable&&n(l.tbody.prev().find("col:not(.k-group-col,.k-hierarchy-col)"),s,e),n(l.thead.find(".k-header:not(.k-group-cell,.k-hierarchy-cell)"),i,e),c&&c.length&&(n(c.find(".k-grid-footer-wrap>table>colgroup>col:not(.k-group-col,.k-hierarchy-col)"),s,e),n(c.find(".k-footer-template>td:not(.k-group-cell,.k-hierarchy-cell)"),i,e)),r=l.tbody.children(":not(.k-grouping-row,.k-detail-row)"),a=0,o=r.length;o>a;a+=1)n(r.eq(a).find(">td:not(.k-group-cell,.k-hierarchy-cell)"),i,e)},cellIndex:function(t){return e(t).parent().children("td:not(.k-group-cell,.k-hierarchy-cell)").index(t)},_modelForContainer:function(t){t=e(t),t.is("tr")||"popup"===this._editMode()||(t=t.closest("tr"));var r=t.attr(g.attr("uid"));return this.dataSource.getByUid(r)},_editable:function(){var t=this,r=t.options.editable,a=function(){var r=document.activeElement,a=t._editContainer;!a||e.contains(a[0],r)||a[0]===r||e(r).closest(".k-animation-container").length||t.editable.end()&&t.closeCell()};if(r){var o=t._editMode();"incell"===o?r.update!==!1&&t.wrapper.on("touchend"+L+" "+tt+L,"tr:not(.k-grouping-row) > td",function(r){var a=e(this);a.hasClass("k-hierarchy-cell")||a.hasClass("k-detail-cell")||a.hasClass("k-group-cell")||a.hasClass("k-edit-cell")||a.has("a.k-grid-delete").length||a.has("button.k-grid-delete").length||a.closest("tbody")[0]!==t.tbody[0]||e(r.target).is(":input")||(t.editable?t.editable.end()&&(t.closeCell(),t.editCell(a)):t.editCell(a))}).on("focusin"+L,function(){clearTimeout(t.timer),t.timer=null}).on("focusout"+L,function(){t.timer=setTimeout(a,1)}):r.update!==!1&&t.wrapper.on("touchend"+L+" "+tt+L,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible a.k-grid-edit",function(r){r.preventDefault(),t.editRow(e(this).closest("tr"))}),r.destroy!==!1?t.wrapper.on("touchend"+L+" "+tt+L,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible .k-grid-delete",function(r){r.preventDefault(),r.stopPropagation(),t.removeRow(e(this).closest("tr"))}):t.wrapper.on("touchend"+L+" "+tt+L,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible button.k-grid-delete",function(e){t._confirmation()||e.preventDefault()})}},editCell:function(e){var t=this,r=t.columns[t.cellIndex(e)],a=t._modelForContainer(e);!a||a.editable&&!a.editable(r.field)||r.command||!r.field||(t._attachModelChange(a),t._editContainer=e,t.editable=e.addClass("k-edit-cell").kendoEditable({fields:{field:r.field,format:r.format,editor:r.editor,values:r.values},model:a,change:function(r){t.trigger(P,{values:r.values,container:e,model:a})&&r.preventDefault()}}).data("kendoEditable"),e.parent().addClass("k-grid-edit-row"),t.trigger(F,{container:e,model:a}))},_destroyEditable:function(){var e=this,t=function(){e.editable&&(e._detachModelChange(),e.editable.destroy(),e.editable=null,e._editContainer=null)};e.editable&&("popup"===e._editMode()?e._editContainer.data("kendoWindow").bind("deactivate",t).close():t())},_attachModelChange:function(e){var t=this;t._modelChangeHandler=function(e){t._modelChange({field:e.field,model:this})},e.bind("change",t._modelChangeHandler)},_detachModelChange:function(){var e=this,t=e._editContainer,r=e._modelForContainer(t);r&&r.unbind(j,e._modelChangeHandler)},closeCell:function(){var t=this,r=t._editContainer.removeClass("k-edit-cell"),a=r.closest("tr").attr(g.attr("uid")),o=t.columns[t.cellIndex(r)],l=t.dataSource.getByUid(a);r.parent().removeClass("k-grid-edit-row"),t._destroyEditable(),t._displayCell(r,o,l),r.hasClass("k-dirty-cell")&&e('<span class="k-dirty"/>').prependTo(r)},_displayCell:function(e,t,r){var a=this,o={storage:{},count:0},l=C({},g.Template,a.options.templateSettings),i=g.template(a._cellTmpl(t,o),l);o.count>0&&(i=R(i,o.storage)),e.empty().html(i(r))},removeRow:function(t){var r,a,o=this;o._confirmation()&&(t=e(t).hide(),r=o._modelForContainer(t),r&&!o.trigger(O,{row:t,model:r})&&(o.dataSource.remove(r),a=o._editMode(),("inline"===a||"popup"===a)&&o.dataSource.sync()))},_editMode:function(){var e="incell",t=this.options.editable;return t!==!0&&(e="string"==typeof t?t:t.mode||e),e},editRow:function(r){var a,o=this,l=o._modelForContainer(r),i=o._editMode(),n=o.options.navigatable;o.cancelRow(),l&&(o._attachModelChange(l),"popup"===i?o._createPopupEditor(l):"inline"===i?o._createInlineEditor(r,l):"incell"===i&&e(r).children(W).each(function(){var r=e(this),a=o.columns[r.index()];return l=o._modelForContainer(r),l&&(!l.editable||l.editable(a.field))&&a.field?(o.editCell(r),!1):t}),a=o._editContainer,a.on("touchend"+L+" "+tt+L,"a.k-grid-cancel",function(t){t.preventDefault(),t.stopPropagation();var r=o.items().index(e(o.current()).parent());o.cancelRow(),n&&(o.current(o.items().eq(r).children().filter(B).first()),o.table.focus())}),a.on("touchend"+L+" "+tt+L,"a.k-grid-update",function(e){e.preventDefault(),e.stopPropagation(),o.saveRow()}))},_createPopupEditor:function(t){var r,a,o,l,i,n,s,d,c=this,u="<div "+g.attr("uid")+'="'+t.uid+'"><div class="k-edit-form-container">',p=[],f=c.options.editable,m=f.template,b=y(f)?f.window:{},k=C({},g.Template,c.options.templateSettings);if(m)for(typeof m===lt&&(m=window.unescape(m)),u+=g.template(m,k)(t),o=0,l=c.columns.length;l>o;o++)r=c.columns[o],r.command&&(a=h(r.command,"edit"));else for(o=0,l=c.columns.length;l>o;o++)if(r=c.columns[o],r.command)r.command&&(a=h(r.command,"edit"));else if(u+='<div class="k-edit-label"><label for="'+r.field+'">'+(r.title||r.field||"")+"</label></div>",t.editable&&!t.editable(r.field)||!r.field){var v={storage:{},count:0};i=g.template(c._cellTmpl(r,v),k),v.count>0&&(i=R(i,v.storage)),u+='<div class="k-edit-field">'+i(t)+"</div>"}else p.push({field:r.field,format:r.format,editor:r.editor,values:r.values}),u+="<div "+g.attr("container-for")+'="'+r.field+'" class="k-edit-field"></div>';a&&y(a)&&(a.text&&y(a.text)&&(n=a.text.update,s=a.text.cancel),a.attr&&(d=a.attr)),u+=c._createButton({name:"update",text:n,attr:d})+c._createButton({name:"canceledit",text:s,attr:d}),u+="</div></div>";var _=c._editContainer=e(u).appendTo(c.wrapper).eq(0).kendoWindow(C({modal:!0,resizable:!1,draggable:!0,title:"Edit",visible:!1,close:function(e){e.userTriggered&&c.cancelRow()}},b));c.editable=c._editContainer.kendoEditable({fields:p,model:t,clearContainer:!1}).data("kendoEditable"),_.data("kendoWindow").center().open(),c.trigger(F,{container:_,model:t})},_createInlineEditor:function(t,r){var a,o,l,i=this,n=[];t.children(":not(.k-group-cell,.k-hierarchy-cell)").each(function(){if(o=e(this),a=i.columns[i.cellIndex(o)],a.command||!a.field||r.editable&&!r.editable(a.field)){if(a.command&&(l=h(a.command,"edit"))){o.empty();var t,s,d;y(l)&&(l.text&&y(l.text)&&(t=l.text.update,s=l.text.cancel),l.attr&&(d=l.attr)),e(i._createButton({name:"update",text:t,attr:d})+i._createButton({name:"canceledit",text:s,attr:d})).appendTo(o)}}else n.push({field:a.field,format:a.format,editor:a.editor,values:a.values}),o.attr("data-container-for",a.field),o.empty()}),i._editContainer=t,i.editable=t.addClass("k-grid-edit-row").kendoEditable({fields:n,model:r,clearContainer:!1}).data("kendoEditable"),i.trigger(F,{container:t,model:r})},cancelRow:function(){var e,t=this,r=t._editContainer;r&&(e=t._modelForContainer(r),t.dataSource.cancelChanges(e),"popup"!==t._editMode()?t._displayRow(r):t._displayRow(t.items().filter("["+g.attr("uid")+"="+e.uid+"]")),t._destroyEditable())},saveRow:function(){var e=this,t=e._editContainer,r=e._modelForContainer(t),a=e.editable;t&&a&&a.end()&&!e.trigger(P,{container:t,model:r})&&e.dataSource.sync()},_displayRow:function(t){var r=this,a=r._modelForContainer(t);a&&t.replaceWith(e((t.hasClass("k-alt")?r.altRowTemplate:r.rowTemplate)(a)))},_showMessage:function(e){return window.confirm(e)},_confirmation:function(){var e=this,t=e.options.editable,r=t===!0||typeof t===lt?it:t.confirmation;return r!==!1&&null!=r?e._showMessage(r):!0},cancelChanges:function(){this.dataSource.cancelChanges()},saveChanges:function(){var e=this;(e.editable&&e.editable.end()||!e.editable)&&!e.trigger(K)&&e.dataSource.sync()},addRow:function(){var e,t=this,r=t.dataSource,a=t._editMode(),o=t.options.editable.createAt||"",l=r.pageSize(),i=r.view()||[];if(t.editable&&t.editable.end()||!t.editable){"incell"!=a&&t.cancelRow(),e=r.indexOf(i[0]),"bottom"==o.toLowerCase()&&(e+=i.length,l&&!r.options.serverPaging&&i.length>=l&&(e-=1)),0>e&&(e=0);var n=r.insert(e,{}),s=n.uid,d=t.table.find("tr["+g.attr("uid")+"="+s+"]"),c=d.children("td:not(.k-group-cell,.k-hierarchy-cell)").first();"inline"!==a&&"popup"!==a||!d.length?c.length&&t.editCell(c):t.editRow(d)}},_toolbar:function(){var t,r,a=this,o=a.wrapper,l=a.options.toolbar,i=a.options.editable;l&&(t=a.wrapper.find(".k-grid-toolbar"),t.length||(l=A(l)?l({}):typeof l===lt?l:a._toolbarTmpl(l).replace(dt,"\\#"),r=R(g.template(l),a),t=e('<div class="k-toolbar k-grid-toolbar" />').html(r({})).prependTo(o)),i&&i.create!==!1&&t.on("touchend"+L+" "+tt+L,".k-grid-add",function(e){e.preventDefault(),a.addRow()}).on("touchend"+L+" "+tt+L,".k-grid-cancel-changes",function(e){e.preventDefault(),a.cancelChanges()}).on("touchend"+L+" "+tt+L,".k-grid-save-changes",function(e){e.preventDefault(),a.saveChanges()}))},_toolbarTmpl:function(e){var t,r,a=this,o="";if(T(e))for(t=0,r=e.length;r>t;t++)o+=a._createButton(e[t]);return o},_createButton:function(e){var t=e.template||ct,r=typeof e===lt?e:e.name||e.text,o={className:"k-grid-"+(r||"").replace(/\s/g,""),text:r,imageClass:"",attr:"",iconClass:""};if(!(r||y(e)&&e.template))throw Error("Custom commands should have name specified");return y(e)?(e.className&&(e.className+=" "+o.className),"edit"===r&&y(e.text)&&(e=C(!0,{},e),e.text=e.text.edit),e.attr&&y(e.attr)&&(e.attr=a(e.attr)),o=C(!0,o,ht[r],e)):o=C(!0,o,ht[r]),g.template(t)(o)},_groupable:function(){var t=this;t.table.on("touchend"+L+" "+tt+L,".k-grouping-row .k-i-collapse, .k-grouping-row .k-i-expand",function(r){var a=e(this),o=a.closest("tr");a.hasClass("k-i-collapse")?t.collapseGroup(o):t.expandGroup(o),r.preventDefault(),r.stopPropagation()}),t._attachGroupable()},_attachGroupable:function(){var t=this,r=t.wrapper,a=t.options.groupable;a&&(r.has("div.k-grouping-header")[0]||e("<div />").addClass("k-grouping-header").prependTo(r),t.groupable&&t.groupable.destroy(),t.groupable=new k(r,C({},a,{draggable:t._draggableInstance,groupContainer:">div.k-grouping-header",dataSource:t.dataSource,filter:".k-header:not(.k-group-cell,.k-hierarchy-cell):visible["+g.attr("field")+"]",allowDrag:t.options.reorderable})))},_selectable:function(){var e,t,r=this,a=r.options.selectable;a&&(e=typeof a===lt&&a.toLowerCase().indexOf("multiple")>-1,t=typeof a===lt&&a.toLowerCase().indexOf("cell")>-1,r.selectable=new g.ui.Selectable(r.table,{filter:">"+(t?q:"tbody>tr:not(.k-grouping-row,.k-detail-row,.k-group-footer)"),aria:!0,multiple:e,change:function(){r.trigger(j)}}),r.options.navigatable&&r.table.on("keydown"+L,function(a){var o=r.current();a.keyCode===w.SPACEBAR&&a.target==r.table[0]&&!o.is(".k-edit-cell,.k-header")&&o.parent().is(":not(.k-grouping-row,.k-detail-row,.k-group-footer)")&&(a.preventDefault(),a.stopPropagation(),o=t?o:o.parent(),e?a.ctrlKey?o.hasClass(Y)&&(o.removeClass(Y),o=null):r.selectable.clear():r.selectable.clear(),r.selectable.value(o))}))},clearSelection:function(){var e=this;e.selectable.clear(),e.trigger(j)},select:function(r){var a=this,o=a.selectable;return r=e(r),r.length?(o.options.multiple||(o.clear(),r=r.first()),o.value(r),t):o.value()},current:function(e){var r=this,a=r.options.scrollable,o=r._current,l=r.table.add(r.thead.parent());return e!==t&&e.length&&(o&&o[0]===e[0]||(o&&(o.removeClass(Q).removeAttr("id"),l.removeAttr("aria-activedescendant")),e.attr("id",r._cellId),r._current=e.addClass(Q),l.attr("aria-activedescendant",r._cellId),e.length&&a&&(r._scrollTo(e.parent()[0],r.content[0]),a.virtual?r._scrollTo(e[0],r.content.find(">.k-virtual-scrollable-wrap")[0]):r._scrollTo(e[0],r.content[0])))),r._current},_removeCurrent:function(){this._current&&(this._current.removeClass(Q),this._current=null)},_scrollTo:function(e,t){var r="td"===e.tagName.toLowerCase(),a=e[r?"offsetLeft":"offsetTop"],o=e[r?"offsetWidth":"offsetHeight"],l=t[r?"scrollLeft":"scrollTop"],i=t[r?"clientWidth":"clientHeight"],n=a+o;t[r?"scrollLeft":"scrollTop"]=l>a?a:n>l+i?n-i:l},_navigatable:function(){var t=this,r=R(t.current,t),a=t.table,o=t.thead.parent(),l=a;t.options.navigatable&&(t.options.scrollable&&(l=a.add(o),o.attr(at,-1)),o.on("keydown"+L,function(e){e.altKey&&e.keyCode==w.DOWN&&(r().find(".k-grid-filter, .k-header-column-menu").click(),e.stopImmediatePropagation())}).find("a.k-link").attr("tabIndex",-1),a.attr(at,E.max(a.attr(at)||0,0)).on("mousedown"+L+" keydown"+L,".k-detail-cell",function(e){e.target!==e.currentTarget&&e.stopImmediatePropagation()}),l.on("mousedown"+L,N+">"+B,R(f,t)).on("focus"+L,function(){var t=r();t&&t.is(":visible")?t.addClass(Q):r(e(this).find(z)),this==a[0]?(o.attr(at,-1),a.attr(at,0)):(a.attr(at,-1),o.attr(at,0))}).on("focusout"+L,function(){var e=r();e&&e.removeClass(Q)}).on("keydown"+L,function(o){var l,i,n,s=o.keyCode,d=!1,c=!o.isDefaultPrevented()&&!e(o.target).is(":button,a,:input,a>.k-icon"),u=t.options.pageable,p=t.dataSource,h="incell"==t._editMode(),f=o.shiftKey,m=g.support.browser,b=r();if(b&&b.is("th")&&(c=!0),c&&s==w.UP)b?(i=b.parent().prevAll(N).first(),i[0]||(i=t.thead.parent().focus().find(N).first()),n=b.index(),b=i.children().eq(n),b[0]&&b.is(B)||(b=i.children(B).first())):b=a.find(z),d=!0,r(b);else if(c&&s==w.DOWN)b?(i=b.parent().nextAll(N).first(),!i[0]&&b.is("th")&&(i=t.tbody.parent().focus().end().find(N).first()),n=b.index(),b=i.children().eq(n),b[0]&&b.is(B)||(b=i.children(B).first())):b=a.find(z),d=!0,r(b);else if(c&&s==w.LEFT)r(b?b.prevAll(W+":first"):a.find(z)),d=!0;else if(c&&s==w.RIGHT)b?b.next()[0]&&(b=b.nextAll(W+":first")):b=a.find(z),d=!0,r(b);else if(c&&u&&w.PAGEDOWN==s)p.page(p.page()+1),d=!0;else if(c&&u&&w.PAGEUP==s)p.page(p.page()-1),d=!0;else if(s==w.ENTER||w.F2==s)if(b=b?b:a.find(z),b.is("th"))b.find(".k-link").click(),d=!0;else if(b.parent().is(".k-master-row,.k-grouping-row"))b.parent().find(".k-icon:first").click(),d=!0;else{var k=b.find(":focusable:first");!b.hasClass("k-edit-cell")&&k[0]&&b.hasClass("k-state-focused")?(k.focus(),d=!0):t.options.editable&&!e(o.target).is(":button,.k-button")&&(t._handleEditing(b),d=!0)}else if(w.ESC==s)b&&e.contains(b[0],document.activeElement)&&!b.hasClass("k-edit-cell")&&!b.parent().hasClass("k-grid-edit-row")?(t.table[0].focus(),d=!0):!t._editContainer||b&&!t._editContainer.has(b[0])&&b[0]!==t._editContainer[0]||(h?t.closeCell():(l=t.items().index(e(b).parent()),document.activeElement.blur(),t.cancelRow(),l>=0&&t.current(t.items().eq(l).children().filter(B).first())),m.msie&&9>parseInt(m.version,10)&&document.body.focus(),a.focus(),d=!0);else if(w.TAB==s){var v;b=e(b),t.options.editable&&h&&(v=e(document.activeElement).closest(".k-edit-cell"),v[0]&&v[0]!==b[0]&&(b=v)),v=f?b.prevAll(W+":first"):b.nextAll(":visible:first"),v.length||(v=b.parent()[f?"prevAll":"nextAll"]("tr:not(.k-grouping-row):not(.k-detail-row):visible:first").children(W+(f?":last":":first"))),!b.is("th")&&v.length&&t.options.editable&&h&&(t._handleEditing(b,v),d=!0)}d&&(o.preventDefault(),o.stopPropagation())}))},_handleEditing:function(r,a){var o,l,i=this,n=e(document.activeElement),s=i._editMode(),d=i._editContainer;if(l="incell"==s?r.hasClass("k-edit-cell"):r.parent().hasClass("k-grid-edit-row"),i.editable){if(e.contains(d[0],n[0])&&(n.blur(),g.support.browser.opera&&n.change()),!i.editable)return i.table.focus(),t;if(!i.editable.end())return"incell"==s?i.current(d):i.current(d.children().filter(W).first()),o=d.find(":focusable:first")[0],o&&o.focus(),t;"incell"==s?i.closeCell():(i.saveRow(),l=!0)}a&&i.current(a),i.table.focus(),(!l&&!a||a)&&("incell"==s?i.editCell(i.current()):i.editRow(i.current().parent()))},_wrapper:function(){var e=this,t=e.table,r=e.options.height,a=e.element;a.is("div")||(a=a.wrap("<div/>").parent()),e.wrapper=a.addClass("k-grid k-widget"),r&&(e.wrapper.css(rt,r),t.css(rt,"auto"))},_tbody:function(){var t,r=this,a=r.table;t=a.find(">tbody"),t.length||(t=e("<tbody/>").appendTo(a)),r.tbody=t},_scrollable:function(){var t,r,a=this,o=a.options,l=o.scrollable,i=l!==!0&&l.virtual&&!a.virtualScrollable,n=!g.support.kineticScrollNeeded||i?g.support.scrollbar():0;if(l){t=a.wrapper.children(".k-grid-header"),t[0]||(t=e('<div class="k-grid-header" />').insertBefore(a.table)),t.css(ut?"padding-left":"padding-right",l.virtual?n+1:n),r=e('<table role="grid" cellspacing="0" />'),r.append(a.thead),t.empty().append(e('<div class="k-grid-header-wrap" />').append(r)),a.content=a.table.parent(),a.content.is(".k-virtual-scrollable-wrap")&&(a.content=a.content.parent()),a.content.is(".k-grid-content, .k-virtual-scrollable-wrap")||(a.content=a.table.wrap('<div class="k-grid-content" />').parent()),i&&(a.virtualScrollable=new pt(a.content,{dataSource:a.dataSource,itemHeight:R(a._averageRowHeight,a)})),a.scrollables=t.children(".k-grid-header-wrap");var s=a.wrapper.find(".k-grid-footer"),d=ut&&e.browser.webkit?n:0;if(s.length&&(a.scrollables=a.scrollables.add(s.children(".k-grid-footer-wrap"))),l.virtual)a.content.find(">.k-virtual-scrollable-wrap").bind("scroll"+L,function(){a.scrollables.scrollLeft(this.scrollLeft+d)});else{a.content.bind("scroll"+L,function(){a.scrollables.scrollLeft(this.scrollLeft+d)});var c=g.touchScroller(a.content);c&&c.movable&&c.movable.bind("change",function(e){a.scrollables.scrollLeft(-e.sender.x)})}}},_setContentHeight:function(){var e=this,t=e.options,r=e.wrapper.innerHeight(),a=e.wrapper.children(".k-grid-header"),o=g.support.scrollbar();if(t.scrollable){r-=a.outerHeight(),e.pager&&(r-=e.pager.element.outerHeight()),t.groupable&&(r-=e.wrapper.children(".k-grouping-header").outerHeight()),t.toolbar&&(r-=e.wrapper.children(".k-grid-toolbar").outerHeight()),e.footerTemplate&&(r-=e.wrapper.children(".k-grid-footer").outerHeight());var l=function(e){var t,r;return e[0].style.height?!0:(t=e.height(),e.height("auto"),r=e.height(),t!=r?(e.height(""),!0):(e.height(""),!1))};l(e.wrapper)&&(r>2*o?e.content.height(r):e.content.height(2*o+1))}},_averageRowHeight:function(){var e=this._rowHeight;return this._rowHeight=e=this.table.outerHeight()/this.table[0].rows.length,e},_dataSource:function(){var e,r=this,a=r.options,o=a.dataSource;o=T(o)?{data:o}:o,y(o)&&(C(o,{table:r.table,fields:r.columns}),e=a.pageable,y(e)&&e.pageSize!==t&&(o.pageSize=e.pageSize)),r.dataSource&&r._refreshHandler?r.dataSource.unbind(j,r._refreshHandler).unbind(I,r._requestStartHandler).unbind(M,r._errorHandler):(r._refreshHandler=R(r.refresh,r),r._requestStartHandler=R(r._requestStart,r),r._errorHandler=R(r._error,r)),r.dataSource=b.create(o).bind(j,r._refreshHandler).bind(I,r._requestStartHandler).bind(M,r._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_modelChange:function(t){var r,a,o,l,i,n=this,s=t.model,d=n.tbody.find("tr["+g.attr("uid")+"="+s.uid+"]"),c=d.hasClass("k-alt");if(d.children(".k-edit-cell").length&&!n.options.rowTemplate)d.children(":not(.k-group-cell,.k-hierarchy-cell)").each(function(){r=e(this),a=n.columns[n.cellIndex(r)],a.field===t.field&&(r.hasClass("k-edit-cell")?r.addClass("k-dirty-cell"):(n._displayCell(r,a,s),e('<span class="k-dirty"/>').prependTo(r)))});else if(!d.hasClass("k-grid-edit-row")){for(o=e((c?n.altRowTemplate:n.rowTemplate)(s)),d.replaceWith(o),l=0,i=n.columns.length;i>l;l++)a=n.columns[l],a.field===t.field&&(r=o.children(":not(.k-group-cell,.k-hierarchy-cell)").eq(l),e('<span class="k-dirty"/>').prependTo(r));n.trigger("itemChange",{item:o,data:s,ns:m})}},_pageable:function(){var t,r=this,a=r.options.pageable;a&&(t=r.wrapper.children("div.k-grid-pager"),t.length||(t=e('<div class="k-pager-wrap k-grid-pager"/>').appendTo(r.wrapper)),r.pager&&r.pager.destroy(),r.pager="object"==typeof a&&a instanceof g.ui.Pager?a:new g.ui.Pager(t,C({},a,{dataSource:r.dataSource})))
},_footer:function(){var t=this,r=t.dataSource.aggregates(),a="",o=t.footerTemplate,l=t.options,n=t.footer||t.wrapper.find(".k-grid-footer");if(o)if(r=D(r)?i(t.dataSource.aggregate()):r,a=e(t._wrapFooter(o(r))),n.length){var s=a;n.replaceWith(s),n=t.footer=s}else n=t.footer=l.scrollable?l.pageable?a.insertBefore(t.wrapper.children("div.k-grid-pager")):a.appendTo(t.wrapper):a.insertBefore(t.tbody);else n&&!t.footer&&(t.footer=n);n.length&&(l.scrollable&&(t.scrollables=t.scrollables.not(".k-grid-footer-wrap").add(t.footer.attr("tabindex",-1).children(".k-grid-footer-wrap"))),l.resizable&&t._footerWidth&&n.find("table").css("width",t._footerWidth))},_wrapFooter:function(t){var r=this,a="",o=g.support.mobileOS?0:g.support.scrollbar();return r.options.scrollable?(a=e('<div class="k-grid-footer"><div class="k-grid-footer-wrap"><table cellspacing="0"><tbody>'+t+"</tbody></table></div></div>"),r._appendCols(a.find("table")),a.css(ut?"padding-left":"padding-right",o),a):'<tfoot class="k-grid-footer">'+t+"</tfoot>"},_columnMenu:function(){var t,r,a,o,l,i,n=this,s=n.columns,d=n.options,c=d.columnMenu,u=function(){n.thead.parent().focus()};c&&("boolean"==typeof c&&(c={}),n.thead.find("th:not(.k-hierarchy-cell,.k-group-cell)").each(function(p){r=s[p],i=e(this),r.command||!r.field&&!i.attr("data-"+g.ns+"field")||(t=i.data("kendoColumnMenu"),t&&t.destroy(),o=r.sortable!==!1&&c.sortable!==!1?d.sortable:!1,l=d.filterable&&r.filterable!==!1&&c.filterable!==!1?C({},r.filterable,d.filterable):!1,a={dataSource:n.dataSource,values:r.values,columns:c.columns,sortable:o,filterable:l,messages:c.messages,owner:n,closeCallback:u},i.kendoColumnMenu(a))}))},_filterable:function(){var t,r,a=this,o=a.columns,l=function(){a.thead.parent().focus()},i=a.options.filterable;i&&!a.options.columnMenu&&a.thead.find("th:not(.k-hierarchy-cell,.k-group-cell)").each(function(n){t=e(this),o[n].filterable===!1||o[n].command||!o[n].field&&!t.attr("data-"+g.ns+"field")||(r=t.data("kendoFilterMenu"),r&&r.destroy(),t.kendoFilterMenu(C(!0,{},i,o[n].filterable,{dataSource:a.dataSource,values:o[n].values,closeCallback:l})))})},_sortable:function(){var t,r=this,a=r.columns,o=r.options.sortable;o&&r.thead.find("th:not(.k-hierarchy-cell,.k-group-cell)").each(function(l){t=a[l],t.sortable!==!1&&!t.command&&t.field&&e(this).attr("data-"+g.ns+"field",t.field).kendoSortable(C({},o,{dataSource:r.dataSource,aria:!0}))})},_columns:function(t){var r,a=this,o=a.table,l=o.find("col"),i=a.options.dataSource;t=t.length?t:S(o.find("th"),function(t,r){t=e(t);var a=t.attr(g.attr("sortable")),o=t.attr(g.attr("filterable")),i=t.attr(g.attr("type")),n=t.attr(g.attr("groupable")),s=t.attr(g.attr("field")),d=t.attr(g.attr("menu"));return s||(s=t.text().replace(/\s|[^A-z0-9]/g,"")),{field:s,type:i,sortable:"false"!==a,filterable:"false"!==o,groupable:"false"!==n,menu:d,template:t.attr(g.attr("template")),width:l.eq(r).css("width")}}),r=!(a.table.find("tbody tr").length>0&&(!i||!i.transport)),a.columns=S(t,function(e){return e=typeof e===lt?{field:e}:e,e.hidden&&(e.attributes=c(e.attributes),e.footerAttributes=c(e.footerAttributes),e.headerAttributes=c(e.headerAttributes)),C({encoded:r},e)})},_groups:function(){var e=this.dataSource.group();return e?e.length:0},_tmpl:function(e,t){var o,l,i,n,s=this,d=C({},g.Template,s.options.templateSettings),c=s.columns.length,u={storage:{},count:0},p=s._hasDetails(),h=[],f=s._groups();if(!e){for(e="<tr",t&&h.push("k-alt"),p&&h.push("k-master-row"),h.length&&(e+=' class="'+h.join(" ")+'"'),c&&(e+=" "+g.attr("uid")+'="#='+d.paramName+'.uid#"'),e+=" role='row'>",f>0&&(e+=r(f)),p&&(e+='<td class="k-hierarchy-cell"><a class="k-icon k-plus" href="\\#" tabindex="-1"></a></td>'),o=0;c>o;o++)i=s.columns[o],l=i.template,n=typeof l,e+="<td"+a(i.attributes)+" role='gridcell'>",e+=s._cellTmpl(i,u),e+="</td>";e+="</tr>"}return e=g.template(e,d),u.count>0?R(e,u.storage):e},_headerCellText:function(e){var t=this,r=C({},g.Template,t.options.templateSettings),a=e.headerTemplate,o=typeof a,l=e.title||e.field||"";return o===ot?l=g.template(a,r)({}):o===lt&&(l=a),l},_cellTmpl:function(e,t){var r,a,o=this,l=C({},g.Template,o.options.templateSettings),i=e.template,n=l.paramName,s=e.field,d="",c=e.format,u=typeof i,p=e.values;if(e.command){if(T(e.command)){for(r=0,a=e.command.length;a>r;r++)d+=o._createButton(e.command[r]);return d.replace(dt,"\\#")}return o._createButton(e.command).replace(dt,"\\#")}return u===ot?(t.storage["tmpl"+t.count]=i,d+="#=this.tmpl"+t.count+"("+n+")#",t.count++):u===lt?d+=i:p&&p.length&&y(p[0])&&"value"in p[0]?(d+="#var v ="+g.stringify(p)+"#",d+="#for (var idx=0,length=v.length;idx<length;idx++) {#",d+="#if (v[idx].value == ",l.useWithBlock||(d+=n+"."),d+=s,d+=") { #",d+="${v[idx].text}",d+="#break;#",d+="#}#",d+="#}#"):(d+=e.encoded?"${":"#=",c&&(d+='kendo.format("'+c.replace(nt,"\\$1")+'",'),s?(s=n+"."+s,d+=s+"==null?'':"+s):d+="''",c&&(d+=")"),d+=e.encoded?"}":"#"),d},_templates:function(){var t=this,r=t.options,a=t.dataSource,o=a.group(),l=t.footer||t.wrapper.find(".k-grid-footer"),i=a.aggregate();t.rowTemplate=t._tmpl(r.rowTemplate),t.altRowTemplate=t._tmpl(r.altRowTemplate||r.rowTemplate,!0),t._hasDetails()&&(t.detailTemplate=t._detailTmpl(r.detailTemplate||"")),(!D(i)&&!l.length||x(t.columns,function(e){return e.footerTemplate}).length)&&(t.footerTemplate=t._footerTmpl(i,"footerTemplate","k-footer-template")),o&&x(t.columns,function(e){return e.groupFooterTemplate}).length&&(i=e.map(o,function(e){return e.aggregates}),t.groupFooterTemplate=t._footerTmpl(i,"groupFooterTemplate","k-group-footer"))},_footerTmpl:function(e,t,o){var l,n,s,d,c,u=this,p=C({},g.Template,u.options.templateSettings),h=p.paramName,f="",m=u.columns,b={},k=0,v={},_=u._groups(),w=i(e);for(f+='<tr class="'+o+'">',_>0&&(f+=r(_)),u._hasDetails()&&(f+='<td class="k-hierarchy-cell">&nbsp;</td>'),l=0,n=u.columns.length;n>l;l++)c=m[l],s=c[t],d=typeof s,f+="<td"+a(c.footerAttributes)+">",s?(d!==ot&&(v=w[c.field]?C({},p,{paramName:h+"."+c.field}):{},s=g.template(s,v)),b["tmpl"+k]=s,f+="#=this.tmpl"+k+"("+h+")#",k++):f+="&nbsp;",f+="</td>";return f+="</tr>",f=g.template(f,p),k>0?R(f,b):f},_detailTmpl:function(e){var t=this,a="",o=C({},g.Template,t.options.templateSettings),l=o.paramName,i={},n=0,s=t._groups(),c=d(t.columns).length,u=typeof e;return a+='<tr class="k-detail-row">',s>0&&(a+=r(s)),a+='<td class="k-hierarchy-cell"></td><td class="k-detail-cell"'+(c?' colspan="'+c+'"':"")+">",u===ot?(i["tmpl"+n]=e,a+="#=this.tmpl"+n+"("+l+")#",n++):a+=e,a+="</td></tr>",a=g.template(a,o),n>0?R(a,i):a},_hasDetails:function(){var e=this;return null!==e.options.detailTemplate||(e._events[G]||[]).length},_details:function(){var t=this;t.table.on("touchend"+L+" "+tt+L,".k-hierarchy-cell .k-plus, .k-hierarchy-cell .k-minus",function(r){var a,o,l=e(this),i=l.hasClass("k-plus"),n=l.closest("tr.k-master-row"),s=t.detailTemplate,d=t._hasDetails();return l.toggleClass("k-plus",!i).toggleClass("k-minus",i),d&&!n.next().hasClass("k-detail-row")&&(o=t.dataItem(n),e(s(o)).addClass(n.hasClass("k-alt")?"k-alt":"").insertAfter(n),t.trigger(G,{masterRow:n,detailRow:n.next(),data:o,detailCell:n.next().find(".k-detail-cell")})),a=n.next(),t.trigger(i?V:X,{masterRow:n,detailRow:a}),a.toggle(i),t._current&&t._current.attr("aria-expanded",i),r.preventDefault(),!1})},dataItem:function(t){return this._data[this.tbody.find("> tr:not(.k-grouping-row,.k-detail-row,.k-group-footer)").index(e(t))]},expandRow:function(t){e(t).find("> td .k-plus, > td .k-i-expand").click()},collapseRow:function(t){e(t).find("> td .k-minus, > td .k-i-collapse").click()},_thead:function(){var r,o,l,i,n,s=this,d=s.columns,c=s._hasDetails()&&d.length,u="",p=s.table.find(">thead");if(p.length||(p=e("<thead/>").insertBefore(s.tbody)),l=s.element.find("tr:has(th):first"),l.length||(l=p.children().first(),l.length||(l=e("<tr/>"))),l.children().length)c&&!l.find(".k-hierarchy-cell")[0]&&l.prepend('<th class="k-hierarchy-cell">&nbsp;</th>');else{for(c&&(u+='<th class="k-hierarchy-cell">&nbsp;</th>'),r=0,o=d.length;o>r;r++)n=d[r],i=s._headerCellText(n),n.command?u+="<th"+a(n.headerAttributes)+">"+i+"</th>":(u+="<th role='columnheader' "+g.attr("field")+"='"+(n.field||"")+"' ",n.title&&(u+=g.attr("title")+'="'+n.title.replace(/'/g,"'")+'" '),n.groupable!==t&&(u+=g.attr("groupable")+"='"+n.groupable+"' "),n.aggregates&&(u+=g.attr("aggregates")+"='"+n.aggregates+"'"),u+=a(n.headerAttributes),u+=">"+i+"</th>");l.html(u)}l.find("th").addClass("k-header"),s.options.scrollable||p.addClass("k-grid-header"),l.find("script").remove().end().appendTo(p),s.thead=p,s._sortable(),s._filterable(),s._scrollable(),s._updateCols(),s._resizable(),s._draggable(),s._reorderable(),s.groupable&&s._attachGroupable(),s._columnMenu()},_updateCols:function(){var e=this;e._appendCols(e.thead.parent().add(e.table))},_appendCols:function(e){var t=this;p(e,d(t.columns),t._hasDetails(),t._groups())},_autoColumns:function(e){if(e&&e.toJSON){var t,r=this;e=e.toJSON();for(t in e)r.columns.push({field:t});r._thead(),r._templates()}},_rowsHtml:function(e){var t,r,a=this,o="",l=a.rowTemplate,i=a.altRowTemplate;for(t=0,r=e.length;r>t;t++)o+=t%2?i(e[t]):l(e[t]),a._data.push(e[t]);return o},_groupRowHtml:function(e,t,a){var o,l,i=this,n="",s=e.field,d=x(i.columns,function(e){return e.field==s})[0]||{},c=d.format?g.format(d.format,e.value):e.value,u=d.groupHeaderTemplate,p=(d.title||s)+": "+c,h=C({},{field:e.field,value:e.value},e.aggregates[e.field]),f=i._groupAggregatesDefaultObject||{},m=e.items;if(u&&(p=typeof u===ot?u(h):g.template(u)(h)),n+='<tr class="k-grouping-row">'+r(a)+'<td colspan="'+t+'" aria-expanded="true">'+'<p class="k-reset">'+'<a class="k-icon k-i-collapse" href="#" tabindex="-1"></a>'+p+"</p></td></tr>",e.hasSubgroups)for(o=0,l=m.length;l>o;o++)n+=i._groupRowHtml(m[o],t-1,a+1);else n+=i._rowsHtml(m);return i.groupFooterTemplate&&(n+=i.groupFooterTemplate(C(f,e.aggregates))),n},collapseGroup:function(r){r=e(r).find(".k-icon").addClass("k-i-expand").removeClass("k-i-collapse").end();var a,o,l=r.find(".k-group-cell").length,i=1;r.find("td:first").attr("aria-expanded",!1),r.nextAll("tr").each(function(){return o=e(this),a=o.find(".k-group-cell").length,o.hasClass("k-grouping-row")?i++:o.hasClass("k-group-footer")&&i--,l>=a||o.hasClass("k-group-footer")&&0>i?!1:(o.hide(),t)})},expandGroup:function(r){r=e(r).find(".k-icon").addClass("k-i-collapse").removeClass("k-i-expand").end();var a,o,l=this,i=r.find(".k-group-cell").length,n=1;r.find("td:first").attr("aria-expanded",!0),r.nextAll("tr").each(function(){return a=e(this),o=a.find(".k-group-cell").length,i>=o?!1:(o!=i+1||a.hasClass("k-detail-row")||(a.show(),a.hasClass("k-grouping-row")&&a.find(".k-icon").hasClass("k-i-collapse")&&l.expandGroup(a),a.hasClass("k-master-row")&&a.find(".k-icon").hasClass("k-minus")&&a.next().show()),a.hasClass("k-grouping-row")&&n++,a.hasClass("k-group-footer")&&(1==n?a.show():n--),t)})},_updateHeader:function(t){var r=this,a=r.thead.find("th.k-group-cell"),o=a.length;t>o?e(Array(t-o+1).join('<th class="k-group-cell k-header">&nbsp;</th>')).prependTo(r.thead.find("tr")):o>t&&(o-=t,e(x(a,function(e,t){return o>t})).remove())},_firstDataItem:function(e,t){return e&&t&&(e=e.hasSubgroups?this._firstDataItem(e.items[0],t):e.items[0]),e},hideColumn:function(t){var r,a,o,l,i,n,s,u,p,h=this,f=0,g=h.footer||h.wrapper.find(".k-grid-footer"),m=h.columns;if(t="number"==typeof t?m[t]:x(m,function(e){return e.field===t})[0],t&&!t.hidden){for(p=H(t,d(m)),t.hidden=!0,t.attributes=c(t.attributes),t.footerAttributes=c(t.footerAttributes),t.headerAttributes=c(t.headerAttributes),h._templates(),h._updateCols(),h.thead.find(">tr>th:not(.k-hierarchy-cell,.k-group-cell):visible").eq(p).hide(),g&&(h._appendCols(g.find("table:first")),g.find(".k-footer-template>td:not(.k-hierarchy-cell,.k-group-cell):visible").eq(p).hide()),r=h.tbody.children(),i=0,u=r.length;u>i;i+=1)a=r.eq(i),a.is(".k-grouping-row,.k-detail-row")?(o=a.children(":not(.k-group-cell):first,.k-detail-cell").last(),o.attr("colspan",parseInt(o.attr("colspan"),10)-1)):(a.hasClass("k-grid-edit-row")&&(o=a.children(".k-edit-container")[0])&&(o=e(o),o.attr("colspan",parseInt(o.attr("colspan"),10)-1),o.find("col").eq(p).remove(),a=o.find("tr:first")),a.children(":not(.k-group-cell,.k-hierarchy-cell):visible").eq(p).hide());for(n=h.thead.prev().find("col"),i=0,u=n.length;u>i;i+=1){if(s=n[i].style.width,!s||-1!=s.indexOf("%")){f=0;break}f+=parseInt(s,10)}l=e(">.k-grid-header table:first,>.k-grid-footer table:first",h.wrapper).add(h.table),f&&l.width(f),e.browser.msie&&8==parseInt(e.browser.version,10)&&(l.css("display","inline-table"),setTimeout(function(){l.css("display","table")},1)),h.trigger(U,{column:t})}},showColumn:function(t){var r,a,o,l,i,n,s,c,h,f,g=this,m=g.columns,b=g.footer||g.wrapper.find(".k-grid-footer");if(t="number"==typeof t?m[t]:x(m,function(e){return e.field===t})[0],t&&t.hidden){for(f=H(t,m),t.hidden=!1,t.attributes=u(t.attributes),t.footerAttributes=u(t.footerAttributes),t.headerAttributes=u(t.headerAttributes),g._templates(),g._updateCols(),g.thead.find(">tr>th:not(.k-hierarchy-cell,.k-group-cell)").eq(f).show(),b&&(g._appendCols(b.find("table:first")),b.find(".k-footer-template>td:not(.k-hierarchy-cell,.k-group-cell)").eq(f).show()),r=g.tbody.children(),a=0,o=r.length;o>a;a+=1)l=r.eq(a),l.is(".k-grouping-row,.k-detail-row")?(i=l.children(":not(.k-group-cell):first,.k-detail-cell").last(),i.attr("colspan",parseInt(i.attr("colspan"),10)+1)):(l.hasClass("k-grid-edit-row")&&(i=l.children(".k-edit-container")[0])&&(i=e(i),i.attr("colspan",parseInt(i.attr("colspan"),10)+1),p(i.find(">form>table"),d(m),!1,0),l=i.find("tr:first")),l.children(":not(.k-group-cell,.k-hierarchy-cell)").eq(f).show());if(n=e(">.k-grid-header table:first,>.k-grid-footer table:first",g.wrapper).add(g.table),t.width){for(s=0,h=g.thead.prev().find("col"),a=0,o=h.length;o>a;a+=1){if(c=h[a].style.width,c.indexOf("%")>-1){s=0;break}s+=parseInt(c,10)}s&&n.width(s)}else n.width("");g.trigger($,{column:t})}},_progress:function(e){var t=this,r=t.element.is("table")?t.element.parent():t.content&&t.content.length?t.content:t.element;g.ui.progress(r,e)},refresh:function(t){var r,a,o,l,n,s=this,c="",u=s.dataSource.view(),p=s.options.navigatable,h=e(s.current()),f=!1,g=(s.dataSource.group()||[]).length,m=g+d(s.columns).length;if(!(t&&"itemchange"===t.action&&s.editable||(t=t||{},s.trigger("dataBinding",{action:t.action||"rebind",index:t.index,items:t.items})))){if(p&&(s.table[0]===document.activeElement||e.contains(s.table[0],document.activeElement))&&(f=h.is("th"),n=0,f&&(n=s.thead.find("th:not(.k-group-cell)").index(h))),s._destroyEditable(),s._progress(!1),s._data=[],s.columns.length||(s._autoColumns(s._firstDataItem(u[0],g)),m=g+s.columns.length),s._group=g>0||s._group,s._group&&(s._templates(),s._updateCols(),s._updateHeader(g),s._group=g>0),g>0)for(s.detailTemplate&&m++,s.groupFooterTemplate&&(s._groupAggregatesDefaultObject=i(s.dataSource.aggregate())),a=0,r=u.length;r>a;a++)c+=s._groupRowHtml(u[a],m,0);else c+=s._rowsHtml(u);v?s.tbody[0].innerHTML=c:(l=document.createElement("div"),l.innerHTML="<table><tbody>"+c+"</tbody></table>",o=l.firstChild.firstChild,s.table[0].replaceChild(o,s.tbody[0]),s.tbody=e(o)),s._footer(),s._setContentHeight(),n>=0&&(s._removeCurrent(),f?s.current(s.thead.find("th:not(.k-group-cell)").eq(n)):s.current(s.items().eq(n).children().filter(W).first()),s._current.closest("table")[0].focus()),s.trigger(J)}}});m.plugin(ft),m.plugin(pt)})(window.kendo.jQuery);