/*
* Kendo UI Complete v2012.3.1315 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
(function(e,i){function t(e){return e!==i}function n(e,i,t){return Math.max(Math.min(e,t),i)}function o(e,i){var t=e.children(x);return t.data("kendoWindow")||t.data("kendo"+i)}function r(i){return e(y).filter(function(){var t=e(this),n=o(t,i);return n.options.modal&&t.is(P)&&n.options.visible}).sort(function(i,t){return+e(i).css("zIndex")-+e(t).css("zIndex")})}function s(e,i){return function(){var e=this,t=e.wrapper,n=t[0].style,o=e.options;if(!o.isMaximized&&!o.isMinimized)return e.restoreOptions={width:n.width,height:n.height},t.find(_).hide().end().find(U).parent().hide().eq(0).before(l.action({name:"Restore"})),i.call(e),e}}function a(e){var i=this;i.owner=e,i._draggable=new h(e.wrapper,{filter:_,group:e.wrapper.id+"-resizing",dragstart:m(i.dragstart,i),drag:m(i.drag,i),dragend:m(i.dragend,i)})}function d(e){var i=this;i.owner=e,i._draggable=new h(e.wrapper,{filter:b,group:e.wrapper.id+"-moving",dragstart:m(i.dragstart,i),drag:m(i.drag,i),dragend:m(i.dragend,i),dragcancel:m(i.dragcancel,i)})}var l,c=window.kendo,p=c.ui.Widget,h=c.ui.Draggable,f=e.isPlainObject,m=e.proxy,u=e.extend,g=e.each,w=c.template,v="body",k=".kendoWindow",y=".k-window",z=".k-window-title",b=z+"bar",x=".k-window-content",_=".k-resize-handle",T=".k-overlay",W="k-content-frame",M="k-loading",C="k-state-hover",H="k-state-focused",P=":visible",S="hidden",O="cursor",D="open",I="activate",L="deactivate",F="close",R="refresh",A="resize",j="dragstart",q="dragend",E="error",N="overflow",G="zIndex",U=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",K=".k-window-titlebar .k-window-action",Q=c.isLocalUrl,B=p.extend({init:function(i,n){var o,r,s,h,u,w,v,_=this,T=!1;p.fn.init.call(_,i,n),n=_.options,i=_.element,u=n.content,_.appendTo=e(n.appendTo||document.body),_._animations(),u&&!f(u)&&(u=n.content={url:u}),i.parent().is(_.appendTo)||(i.find("script").filter(function(){return!this.type||this.type.toLowerCase().indexOf("script")>=0}).remove(),i.is(P)?(r=i.offset(),T=!0):(s=i.css("visibility"),h=i.css("display"),i.css({visibility:S,display:""}),r=i.offset(),i.css({visibility:s,display:h}))),t(n.visible)&&null!==n.visible||(n.visible=i.is(P)),o=_.wrapper=i.closest(y),i.is(".k-content")&&o[0]||(i.addClass("k-window-content k-content"),_._createWindow(i,n),o=_.wrapper=i.closest(y),_._dimensions()),r&&o.css({top:r.top,left:r.left}),u&&_.refresh(u),_.toFront(),w=o.children(x),_._tabindex(w),n.visible&&n.modal&&_._overlay(o.is(P)).css({opacity:.5}),o.on("mouseenter"+k,K,function(){e(this).addClass(C)}).on("mouseleave"+k,K,function(){e(this).removeClass(C)}).on("touchend"+k+" click"+k,K,m(_._windowActionHandler,_)),w.on("keydown"+k,m(_._keydown,_)).on("focus"+k,function(){o.addClass(H)}).on("blur"+k,function(){o.removeClass(H)}),n.resizable&&(o.on("dblclick"+k,b,m(_.toggleMaximization,_)),g("n e s w se sw ne nw".split(" "),function(e,i){o.append(l.resizeHandle(i))}),_.resizing=new a(_)),n.draggable&&(_.dragging=new d(_)),v=i.attr("id"),v&&(v+="_wnd_title",o.find(b).children(z).attr("id",v),w.attr({role:"dialog","aria-labelledby":v})),o.add(o.find(".k-resize-handle,.k-window-titlebar")).on("mousedown"+k,m(_.toFront,_)),_.touchScroller=c.touchScroller(i),_._resizeHandler=function(e){return _._onDocumentResize(e)},e(window).on("resize",_._resizeHandler),n.visible&&(_.element.focus(),_.trigger(D),_.trigger(I)),c.notify(_)},_dimensions:function(){var e=this,i=e.wrapper,t=e.element,n=e.options;e.title(n.title),n.width&&i.width(n.width),n.height&&i.height(n.height),g(["minWidth","minHeight","maxWidth","maxHeight"],function(e,i){var o=n[i];o&&1/0!=o&&t.css(i,o)}),n.visible||i.hide()},_animations:function(){var e=this.options;e.animation===!1&&(e.animation={open:{effects:{}},close:{hide:!0,effects:{}}})},setOptions:function(e){p.fn.setOptions.call(this,e),this._animations(),this._dimensions()},events:[D,I,L,F,R,A,j,q,E],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:1/0,maxHeight:1/0,visible:null},_closable:function(){return e.inArray("close",e.map(this.options.actions,function(e){return e.toLowerCase()}))>-1},_keydown:function(e){var i,t,o,r,s=this,a=s.options,d=c.keys,l=e.keyCode,p=s.wrapper,h=10,f=s.options.isMaximized;e.target==e.currentTarget&&(l==d.ESC&&s._closable()&&s._close(!0),!a.draggable||e.ctrlKey||f||(i=p.offset(),l==d.UP?t=p.css("top",i.top-h):l==d.DOWN?t=p.css("top",i.top+h):l==d.LEFT?t=p.css("left",i.left-h):l==d.RIGHT&&(t=p.css("left",i.left+h))),a.resizable&&e.ctrlKey&&!f&&(l==d.UP?(t=!0,r=p.height()-h):l==d.DOWN&&(t=!0,r=p.height()+h),l==d.LEFT?(t=!0,o=p.width()-h):l==d.RIGHT&&(t=!0,o=p.width()+h),t&&(p.css({width:n(o,a.minWidth,a.maxWidth),height:n(r,a.minHeight,a.maxHeight)}),s.trigger(A))),t&&e.preventDefault())},_overlay:function(i){var t=this.appendTo.children(".k-overlay"),n=this.wrapper;return t.length||(t=e("<div class='k-overlay' />")),t.insertBefore(n[0]).toggle(i).css(G,parseInt(n.css(G),10)-1),t},_windowActionHandler:function(t){var n=e(t.target).closest(".k-window-action").find(".k-icon"),o=this;g({"k-i-close":function(){o._close(!0)},"k-i-maximize":o.maximize,"k-i-minimize":o.minimize,"k-i-restore":o.restore,"k-i-refresh":o.refresh},function(e,r){return n.hasClass(e)?(t.preventDefault(),r.call(o),!1):i})},center:function(){var i=this.wrapper,t=e(window);return i.css({left:t.scrollLeft()+Math.max(0,(t.width()-i.width())/2),top:t.scrollTop()+Math.max(0,(t.height()-i.height())/2)}),this},title:function(e){var i=this,t=i.wrapper,n=i.options,o=t.find(b),r=o.children(z),s=o.outerHeight();return arguments.length?(e===!1?(t.addClass("k-window-titleless"),o.remove()):(o.length||t.prepend(l.titlebar(u(l,n))),t.css("padding-top",s),o.css("margin-top",-s)),r.text(e),i):r.text()},content:function(e){var i=this.wrapper.children(x);return e?(i.html(e),this):i.html()},open:function(){var i,t=this,n=t.wrapper,o=t.options,r=o.animation.open,s=n.children(x),a=s.css(N);return t.trigger(D)||(t.toFront(),t.element.focus(),o.visible=!0,o.modal&&(i=t._overlay(!1),r.duration?i.kendoStop().kendoAnimate({effects:"fade:in",duration:r.duration}):i.css("opacity",.5).show()),n.is(P)||(s.css(N,S),n.show().kendoStop().kendoAnimate({effects:r.effects,duration:r.duration,complete:function(){t.element.focus(),t.trigger(I),s.css(N,a)}}))),o.isMaximized&&(t._documentScrollTop=e(document).scrollTop(),e("html, body").css(N,S)),t},_close:function(t){var n,s,a,d=this,l=d.wrapper,c=d.options,p=c.animation.open,h=c.animation.close;l.is(P)&&!d.trigger(F,{userTriggered:!!t})&&(c.visible=!1,e(y).each(function(i,t){var n=e(t),o=n.find(x);t!=l&&o.find("> ."+W).length>0&&o.children(".k-overlay").remove()}),n=r(c.name),s=c.modal&&!n.length,a=c.modal?d._overlay(!0):e(i),s?h.duration?a.kendoStop().kendoAnimate({effects:"fade:out",duration:h.duration,hide:!0}):a.hide():n.length&&o(n.eq(n.length-1),c.name)._overlay(!0),l.kendoStop().kendoAnimate({effects:h.effects||p.effects,reverse:h.reverse===!0,duration:h.duration,complete:function(){l.hide(),d.trigger(L)}})),d.options.isMaximized&&(e("html, body").css(N,""),d._documentScrollTop&&d._documentScrollTop>0&&e(document).scrollTop(d._documentScrollTop))},close:function(){return this._close(!1),this},toFront:function(i){var t=this,n=t.wrapper,o=n[0],r=+n.css(G),s=r,a=document.activeElement,d=t.element,c=i&&i.target?i.target:null;if(e(y).each(function(i,t){var n=e(t),s=n.css(G),a=n.find(x);isNaN(s)||(r=Math.max(+s,r)),t!=o&&a.find("> ."+W).length>0&&a.append(l.overlay)}),(10001==r||r>s)&&n.css(G,r+2),t.element.find("> .k-overlay").remove(),!(e(a).is(d)||e(c).is(K+","+K+" .k-icon,:input")||d.find(a).length&&d.find(c).length)){d.focus();var p=e(window).scrollTop(),h=parseInt(t.wrapper.position().top,10);h>0&&0>h-p&&(p>0?e(window).scrollTop(h):t.wrapper.css("top",p))}return t},toggleMaximization:function(){return this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var i=this,t=i.options,n=i.restoreOptions;if(t.isMaximized||t.isMinimized)return i.wrapper.css({position:"absolute",left:n.left,top:n.top,width:n.width,height:n.height}).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(U).parent().show(),e("html, body").css(N,""),this._documentScrollTop&&this._documentScrollTop>0&&e(document).scrollTop(this._documentScrollTop),t.isMaximized=t.isMinimized=!1,i.trigger(A),i},maximize:s("maximize",function(){var i=this,t=i.wrapper,n=t.position();u(i.restoreOptions,{left:n.left,top:n.top}),t.css({left:0,top:0,position:"fixed"}),this._documentScrollTop=e(document).scrollTop(),e("html, body").css(N,S),i.options.isMaximized=!0,i._onDocumentResize()}),minimize:s("minimize",function(){var e=this;e.wrapper.css("height",""),e.element.hide(),e.options.isMinimized=!0}),_onDocumentResize:function(){var i=this,t=i.wrapper,n=e(window);i.options.isMaximized&&(t.css({width:n.width(),height:n.height()-parseInt(t.css("padding-top"),10)}),i.trigger(A))},refresh:function(i){var n,o,r,s=this,a=s.options,d=e(s.element);return f(i)||(i={url:i}),i=u({},a.content,i),o=t(a.iframe)?a.iframe:i.iframe,r=i.url,r?(t(o)||(o=!Q(r)),o?(n=d.find("."+W)[0],n?n.src=r||n.src:d.html(l.contentFrame(u({},a,{content:i}))),d.find("."+W).unbind("load"+k).on("load"+k,function(){s.trigger(R)})):s._ajaxRequest(i)):(i.template&&s.content(w(i.template)({})),s.trigger(R)),s},_ajaxRequest:function(e){var i=this,t=e.template,n=i.wrapper.find(".k-window-titlebar .k-i-refresh"),o=setTimeout(function(){n.addClass(M)},100);jQuery.ajax(u({type:"GET",dataType:"html",cache:!1,error:m(function(e,t){i.trigger(E,{status:t,xhr:e})},i),complete:function(){clearTimeout(o),n.removeClass(M)},success:m(function(e){t&&(e=w(t)(e||{})),i.element.html(e),i.trigger(R)},i)},e))},destroy:function(){var i,t,n=this;p.fn.destroy.call(n),c.destroy(n.wrapper),n.resizing&&n.resizing.destroy(),n.dragging&&n.dragging.destroy(),n.wrapper.remove().add(n.wrapper.find(".k-resize-handle,.k-window-titlebar")).off(k),e(window).off("resize",n._resizeHandler),i=r(),t=n.options.modal&&!i.length,t?n._overlay(!1).remove():i.length>0&&o(i.eq(i.length-2),n.options.name)._overlay(!0)},_createWindow:function(){var i,t,n=this,o=n.element,r=n.options,s=c.support.isRtl(o);r.scrollable===!1&&o.attr("style","overflow:hidden;"),r.iframe&&r.content&&o.html(l.contentFrame(r)),t=e(l.wrapper(r)),r.title!==!1&&t.append(l.titlebar(u(l,r))),i=o.find("iframe:not(.k-content)").map(function(){var e=this.getAttribute("src");return this.src="",e}),t.toggleClass("k-rtl",s).appendTo(n.appendTo).append(o).find("iframe:not(.k-content)").each(function(e){this.src=i[e]}),t.find(".k-window-title").css(s?"left":"right",t.find(".k-window-actions").outerWidth()+10),o.show()}});l={wrapper:w("<div class='k-widget k-window' />"),action:w("<a role='button' href='\\#' class='k-window-action k-link'><span role='presentation' class='k-icon k-i-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:w("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:w("<iframe frameborder='0' title='#= title #' class='"+W+"' "+"src='#= content.url #'>"+"This page requires frames in order to show content"+"</iframe>"),resizeHandle:w("<div class='k-resize-handle k-resize-#= data #'></div>")},a.prototype={dragstart:function(i){var t=this,n=t.owner,o=n.wrapper;t.elementPadding=parseInt(n.wrapper.css("padding-top"),10),t.initialCursorPosition=o.offset(),t.resizeDirection=i.currentTarget.prop("className").replace("k-resize-handle k-resize-",""),t.initialSize={width:o.width(),height:o.height()},t.containerOffset=n.appendTo.offset(),o.append(l.overlay).find(_).not(i.currentTarget).hide(),e(v).css(O,i.currentTarget.css(O))},drag:function(e){var i,t,o,r,s=this,a=s.owner,d=a.wrapper,l=a.options,c=s.resizeDirection,p=s.containerOffset,h=s.initialCursorPosition,f=s.initialSize,m=e.x.location,u=e.y.location;c.indexOf("e")>=0?(i=m-h.left,d.width(n(i,l.minWidth,l.maxWidth))):c.indexOf("w")>=0&&(r=h.left+f.width,i=n(r-m,l.minWidth,l.maxWidth),d.css({left:r-i-p.left,width:i})),c.indexOf("s")>=0?(t=u-h.top-s.elementPadding,d.height(n(t,l.minHeight,l.maxHeight))):c.indexOf("n")>=0&&(o=h.top+f.height,t=n(o-u,l.minHeight,l.maxHeight),d.css({top:o-t-p.top,height:t})),a.trigger(A)},dragend:function(i){var t=this,n=t.owner,o=n.wrapper;return o.find(T).remove().end().find(_).not(i.currentTarget).show(),e(v).css(O,""),n.touchScroller&&n.touchScroller.reset(),27==i.keyCode&&o.css(t.initialCursorPosition).css(t.initialSize),!1},destroy:function(){this._draggable.destroy()}},d.prototype={dragstart:function(i){var t=this.owner,n=t.element,o=n.find(".k-window-actions"),r=t.appendTo.offset();t.trigger(j),t.initialWindowPosition=t.wrapper.position(),t.startPosition={left:i.x.client-t.initialWindowPosition.left,top:i.y.client-t.initialWindowPosition.top},t.minLeftPosition=o.length>0?o.outerWidth()+parseInt(o.css("right"),10)-n.outerWidth():20-n.outerWidth(),t.minLeftPosition-=r.left,t.minTopPosition=-r.top,t.wrapper.append(l.overlay).find(_).hide(),e(v).css(O,i.currentTarget.css(O))},drag:function(i){var t=this.owner,n={left:Math.max(i.x.client-t.startPosition.left,t.minLeftPosition),top:Math.max(i.y.client-t.startPosition.top,t.minTopPosition)};e(t.wrapper).css(n)},_finishDrag:function(){var i=this.owner;i.wrapper.find(_).toggle(!i.options.isMinimized).end().find(T).remove(),e(v).css(O,"")},dragcancel:function(e){this._finishDrag(),e.currentTarget.closest(y).css(this.owner.initialWindowPosition)},dragend:function(){return this._finishDrag(),this.owner.trigger(q),!1},destroy:function(){this._draggable.destroy()}},c.ui.plugin(B)})(window.kendo.jQuery);